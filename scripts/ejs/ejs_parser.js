ejs.EJSParser = (function(ES5Parser, _) {

  var EJSParser=ES5Parser.inherit({_grammarName: "EJSParser",
  "punctuator":function(){var p;return this._or((function(){return (function(){p=(function(){switch(this._apply('anything')){case ".":return (function(){switch(this._apply('anything')){case "=":return ".=";case ".":return this._or((function(){return (function(){switch(this._apply('anything')){case ".":return "...";default: this.bt.mismatch('Jumptable did not match')}}).call(this)}),(function(){return ".."}));default: this.bt.mismatch('Jumptable did not match')}}).call(this);case "<":return (function(){this._applyWithArgs("exactly","|");return "<|"}).call(this);default: this.bt.mismatch('Jumptable did not match')}}).call(this);return _.Punctuator(p)}).call(this)}),(function(){return ES5Parser._superApplyWithArgs(this,'punctuator')}))},
  "specialId":function(){var x,i;return (function(){x=this._apply("anything");this._apply("spaces");i=this._apply("identifier");this._pred((i === x));return i}).call(this)},
  "nil":function(){return (function(){this._applyWithArgs("specialId","nil");return _.Id("undefined")}).call(this)},
  "stringExpr":function(){var cs;return (function(){this._apply("spaces");return (function(){switch(this._apply('anything')){case "\"":return this._or((function(){return (function(){switch(this._apply('anything')){case "\"":return (function(){"\"\"";return _.String("")}).call(this);default: this.bt.mismatch('Jumptable did not match')}}).call(this)}),(function(){return (function(){cs=this._many1((function(){return this._or((function(){return this._apply("strSubst")}),(function(){return this._apply("strPart")}))}));this._applyWithArgs("exactly","\"");return _.StringExpr(cs)}).call(this)}));default: this.bt.mismatch('Jumptable did not match')}}).call(this)}).call(this)},
  "strSubst":function(){var e;return (function(){this._applyWithArgs("exactly","#");this._applyWithArgs("exactly","{");"#{";this._apply("spaces");e=this._apply("expr");this._apply("spaces");this._applyWithArgs("exactly","}");return e}).call(this)},
  "strPart":function(){var cs;return (function(){cs=this._consumedBy((function(){return this._many1((function(){return this._or((function(){return this._apply("escapeChar")}),(function(){return (function(){this._not((function(){return (function(){switch(this._apply('anything')){case "\"":return "\"";case "#":return (function(){this._applyWithArgs("exactly","{");return "#{"}).call(this);default: this.bt.mismatch('Jumptable did not match')}}).call(this)}));return this._apply("char")}).call(this)}))}))}));return _.String(cs)}).call(this)},
  "primExpr":function(){return this._or((function(){return this._apply("stringExpr")}),(function(){return this._apply("nil")}),(function(){return ES5Parser._superApplyWithArgs(this,'primExpr')}))},
  "orExpr":function(){var y,x;return this._or((function(){return (function(){x=this._apply("orExpr");this._applyWithArgs("specialId","or");y=this._apply("andExpr");return _.BinaryExpr(x,y).operator("||")}).call(this)}),(function(){return ES5Parser._superApplyWithArgs(this,'orExpr')}))},
  "andExpr":function(){var y,x;return this._or((function(){return (function(){x=this._apply("andExpr");this._applyWithArgs("specialId","and");y=this._apply("bitOrExpr");return _.BinaryExpr(x,y).operator("&&")}).call(this)}),(function(){return ES5Parser._superApplyWithArgs(this,'andExpr')}))},
  "unaryExpr":function(){var p;return this._or((function(){return (function(){this._applyWithArgs("specialId","not");p=this._apply("unaryExpr");return _.UnaryExpr(p).operator("!")}).call(this)}),(function(){return ES5Parser._superApplyWithArgs(this,'unaryExpr')}))},
  "lambdaExpr":function(){var a,args,ss;return (function(){this._applyWithArgs("token","{");args=this._or((function(){return (function(){this._applyWithArgs("token","||");return []}).call(this)}),(function(){return (function(){this._applyWithArgs("token","|");this._apply("spaces");a=this._applyWithArgs("listOf","formal",",");this._applyWithArgs("token","|");return a}).call(this)}));this._apply("spaces");ss=this._many((function(){return this._apply("srcElem")}));this._applyWithArgs("token","}");return _.LambdaExpr(_.FunctionArgs(args),_.BlockStmt(ss))}).call(this)},
  "funcExpr":function(){return this._or((function(){return this._apply("lambdaExpr")}),(function(){return ES5Parser._superApplyWithArgs(this,'funcExpr')}))},
  "funcArgs":function(){var args,r;return this._or((function(){return (function(){args=this._applyWithArgs("listOf","formal",",");this._applyWithArgs("token",",");this._applyWithArgs("token","...");r=this._applyWithArgs("token","Id");return _.FunctionArgs(args).rest(r)}).call(this)}),(function(){return ES5Parser._superApplyWithArgs(this,'funcArgs')}))},
  "forceScopeExpr":function(){var b;return (function(){this._apply("spaces");this._applyWithArgs("exactly","!");b=this._apply("block");return _.ScopeExpr(b)}).call(this)},
  "extendOpExpr":function(){var b,e;return (function(){b=this._apply("leftExpr");this._apply("spaces");this._applyWithArgs("token",".=");e=this._apply("objectLiteral");return _.ExtendExpr(b,e)}).call(this)},
  "assignExpr":function(){return this._or((function(){return this._apply("forceScopeExpr")}),(function(){return this._apply("extendOpExpr")}),(function(){return ES5Parser._superApplyWithArgs(this,'assignExpr')}))},
  "lambdaCallExpr":function(){var p,f,a,args;return (function(){p=this._apply("anything");args=this._or((function(){return (function(){this._applyWithArgs("token","(");a=this._applyWithArgs("listOf","assignExpr",",");this._applyWithArgs("token",")");return a}).call(this)}),(function(){return (function(){this._apply("empty");return []}).call(this)}));f=this._apply("lambdaExpr");return _.CallExpr(p,args.concat(f))}).call(this)},
  "sliceExpr":function(){var p,e,s;return (function(){p=this._apply("anything");this._applyWithArgs("token","[");s=this._apply("expr");this._applyWithArgs("token","..");e=this._apply("expr");this._applyWithArgs("token","]");return _.SliceExpr(p,s,e)}).call(this)},
  "extendExpr":function(){var p,o;return (function(){p=this._apply("anything");this._applyWithArgs("token",".");this._lookahead((function(){return this._applyWithArgs("exactly","{")}));o=this._apply("objectLiteral");return _.ExtendExpr(p,o)}).call(this)},
  "protoExpr":function(){var p,e;return (function(){p=this._apply("anything");this._apply("spaces");this._applyWithArgs("exactly","<");this._applyWithArgs("exactly","|");"<|";e=this._or((function(){return this._apply("primExpr")}),(function(){return this._apply("funcExpr")}));return _.PrototypeExpr(p,e)}).call(this)},
  "instanceExpr":function(){var i;return (function(){this._apply("spaces");this._applyWithArgs("exactly","@");i=this._apply("identifier");return _.MemberExpr(_.ThisExpr()).name(i)}).call(this)},
  "accessExpr":function(){var p;return this._or((function(){return (function(){p=this._apply("accessExpr");return this._applyWithArgs("lambdaCallExpr",p)}).call(this)}),(function(){return (function(){p=this._apply("accessExpr");return this._applyWithArgs("sliceExpr",p)}).call(this)}),(function(){return (function(){p=this._apply("accessExpr");return this._applyWithArgs("extendExpr",p)}).call(this)}),(function(){return (function(){p=this._apply("accessExpr");return this._applyWithArgs("protoExpr",p)}).call(this)}),(function(){return ES5Parser._superApplyWithArgs(this,'accessExpr')}),(function(){return this._apply("instanceExpr")}))},
  "sc":function(){return this._or((function(){return (function(){this._apply("spacesNoNl");return this._or((function(){return this._apply("linebreak")}),(function(){return this._lookahead((function(){return this._applyWithArgs("exactly","}")}))}),(function(){return this._apply("end")}),(function(){return this._applyWithArgs("specialId","end")}))}).call(this)}),(function(){return this._applyWithArgs("token",";")}))},
  "block":function(){var ss;return this._or((function(){return (function(){this._applyWithArgs("token","do");ss=this._many((function(){return (function(){this._not((function(){return this._applyWithArgs("specialId","end")}));return this._apply("srcElem")}).call(this)}));this._or((function(){return this._applyWithArgs("specialId","end")}),(function(){return this._lookahead((function(){return this._applyWithArgs("token","else")}))}));return _.BlockStmt(ss)}).call(this)}),(function(){return ES5Parser._superApplyWithArgs(this,'block')}))},
  "loop":function(){var s;return (function(){this._applyWithArgs("specialId","loop");s=this._apply("stmt");return _.ForStmt(undefined,undefined,undefined,s)}).call(this)},
  "if":function(){var f,t,c;return (function(){this._applyWithArgs("token","if");this._or((function(){return (function(){this._applyWithArgs("token","(");c=this._apply("expr");this._applyWithArgs("token",")");return t=this._apply("stmt")}).call(this)}),(function(){return (function(){c=this._apply("expr");return t=this._apply("block")}).call(this)}));f=this._opt((function(){return (function(){this._applyWithArgs("token","else");return this._apply("stmt")}).call(this)}));return _.IfStmt(c,t,f)}).call(this)},
  "unless":function(){var f,t,c;return (function(){this._applyWithArgs("specialId","unless");this._or((function(){return (function(){this._applyWithArgs("token","(");c=this._apply("expr");this._applyWithArgs("token",")");return t=this._apply("stmt")}).call(this)}),(function(){return (function(){c=this._apply("expr");return t=this._apply("block")}).call(this)}));f=this._opt((function(){return (function(){this._applyWithArgs("token","else");return this._apply("stmt")}).call(this)}));return _.IfStmt(_.UnaryExpr(_.GroupExpr(c)).operator("!"),t,f)}).call(this)},
  "postIf":function(){var t,c;return (function(){t=this._apply("expr");this._applyWithArgs("token","if");this._or((function(){return (function(){this._applyWithArgs("token","(");c=this._apply("expr");return this._applyWithArgs("token",")")}).call(this)}),(function(){return c=this._apply("expr")}));this._apply("sc");return _.IfStmt(c,t,undefined)}).call(this)},
  "postUnless":function(){var t,c;return (function(){t=this._apply("expr");this._applyWithArgs("specialId","unless");this._or((function(){return (function(){this._applyWithArgs("token","(");c=this._apply("expr");return this._applyWithArgs("token",")")}).call(this)}),(function(){return c=this._apply("expr")}));this._apply("sc");return _.IfStmt(_.UnaryExpr(_.GroupExpr(c)).operator("!"),t,undefined)}).call(this)},
  "debug":function(){var s;return (function(){this._applyWithArgs("specialId","debug");this._apply("spaces");s=this._apply("stmt");return _.DebugStmt(s)}).call(this)},
  "module":function(){var b,n;return (function(){this._applyWithArgs("specialId","module");this._apply("spaces");n=this._consumedBy((function(){return (function(){this._apply("name");return this._many((function(){return (function(){this._applyWithArgs("exactly",".");return this._apply("name")}).call(this)}))}).call(this)}));b=this._apply("block");return _.ModuleStmt(n,b)}).call(this)},
  "klass":function(){var p,f,e,s,n,c;return (function(){this._applyWithArgs("token","class");this._apply("spaces");n=this._consumedBy((function(){return (function(){this._apply("name");return this._many((function(){return (function(){this._applyWithArgs("exactly",".");return this._apply("name")}).call(this)}))}).call(this)}));this._opt((function(){return (function(){this._applyWithArgs("token","<");this._apply("spaces");return e=this._consumedBy((function(){return (function(){this._apply("name");return this._many((function(){return (function(){this._applyWithArgs("exactly",".");return this._apply("name")}).call(this)}))}).call(this)}))}).call(this)}));this._applyWithArgs("token","{");s=this._many((function(){return this._apply("klassSect")}));c=this._opt((function(){return (function(){f=this._apply("funcExpr");this._pred(f.is("id",undefined));return f}).call(this)}));p=this._apply("klassProps");this._applyWithArgs("token","}");return _.ClassStmt(n,e,_.ObjectExpr(s),_.ObjectExpr(p),c)}).call(this)},
  "klassSect":function(){var p,f,n,r,c;return (function(){this._apply("spaces");n=this._applyWithArgs("token","Id");this._not((function(){return this._applyWithArgs("exactly",":")}));c=this._or((function(){return (function(){this._apply("sc");return _.ArrayExpr()}).call(this)}),(function(){return (function(){this._applyWithArgs("token","{");this._applyWithArgs("token","}");return _.ArrayExpr()}).call(this)}),(function(){return (function(){this._applyWithArgs("token","{");this._apply("spaces");p=this._or((function(){return (function(){f=this._apply("objBinding");r=this._many((function(){return (function(){this._applyWithArgs("exactly",",");return this._apply("objBinding")}).call(this)}));return _.ObjectExpr([f].concat(r))}).call(this)}),(function(){return (function(){f=this._apply("assignExpr");r=this._many((function(){return (function(){this._applyWithArgs("exactly",",");return this._apply("assignExpr")}).call(this)}));return _.ArrayExpr([f].concat(r))}).call(this)}));this._applyWithArgs("token","}");return p}).call(this)}),(function(){return (function(){this._applyWithArgs("token","{");this._apply("spaces");p=this._or((function(){return (function(){f=this._apply("objBinding");r=this._many((function(){return (function(){this._apply("sc");return this._apply("objBinding")}).call(this)}));return _.ObjectExpr([f].concat(r))}).call(this)}),(function(){return (function(){f=this._apply("assignExpr");r=this._many((function(){return (function(){this._apply("sc");return this._apply("assignExpr")}).call(this)}));return _.ArrayExpr([f].concat(r))}).call(this)}));this._applyWithArgs("token","}");return p}).call(this)}),(function(){return (function(){this._apply("spaces");this._not((function(){return this._applyWithArgs("exactly","{")}));r=this._applyWithArgs("listOf","assignExpr",",");return _.ArrayExpr(r)}).call(this)}));return _.PropertyBinding(n,c)}).call(this)},
  "klassProps":function(){var f,r;return (function(){this._apply("spaces");return this._or((function(){return (function(){f=this._apply("klassProp");r=this._many((function(){return (function(){this._or((function(){return this._apply("sc")}),(function(){return this._applyWithArgs("token",",")}));return this._apply("klassProp")}).call(this)}));return [f].concat(r)}).call(this)}),(function(){return (function(){this._apply("empty");return []}).call(this)}))}).call(this)},
  "klassProp":function(){var f;return this._or((function(){return this._apply("objBinding")}),(function(){return (function(){f=this._apply("klassMethod");this._pred(f.not("id",undefined));return _.PropertyBinding(f.id(),f)}).call(this)}))},
  "klassMethod":function(){var n,args,block;return (function(){n=this._applyWithArgs("token","Id");this._applyWithArgs("token","(");args=this._apply("funcArgs");this._applyWithArgs("token",")");block=this._apply("block");return _.Function(args,block).id(n.value())}).call(this)},
  "forOf":function(){var e,s,v;return (function(){this._applyWithArgs("token","for");this._applyWithArgs("token","(");v=this._apply("bindings");this._applyWithArgs("specialId","of");e=this._apply("expr");this._applyWithArgs("token",")");s=this._apply("stmt");return _.ForOfStmt(v,e,s)}).call(this)},
  "stmt":function(){return this._or((function(){return this._apply("loop")}),(function(){return this._apply("if")}),(function(){return this._apply("unless")}),(function(){return this._apply("postIf")}),(function(){return this._apply("postUnless")}),(function(){return this._apply("debug")}),(function(){return this._apply("module")}),(function(){return this._apply("forOf")}),(function(){return this._apply("klass")}),(function(){return ES5Parser._superApplyWithArgs(this,'stmt')}))}});(EJSParser["parse"]=(function (input,options){return EJSParser.matchAll(input,"topLevel")}));

  return EJSParser;

})(es5.ES5Parser, ejs.nodes);
